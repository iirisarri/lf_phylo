#!/usr/bin/perl

use strict;
use warnings;

# Iker Irisarri, University of Konstanz. Feb 2016
# Simple script to generate infiles for PATHd8
# Originally to test molecular clock for MRCA teleosts and sarcopterygians

my $tree = $ARGV[0] or die;

my %gene_lengths = (	"RAxML_bestTree.G15411"	=>	"306",
						"RAxML_bestTree.G15511"	=>	"620",
						"RAxML_bestTree.G15536"	=>	"361",
						"RAxML_bestTree.G15619"	=>	"574",
						"RAxML_bestTree.G15795"	=>	"635",
						"RAxML_bestTree.G15802"	=>	"221",
						"RAxML_bestTree.G15803"	=>	"752",
						"RAxML_bestTree.G15805"	=>	"246",
						"RAxML_bestTree.G15806"	=>	"498",
						"RAxML_bestTree.G15807"	=>	"317",
						"RAxML_bestTree.G15809"	=>	"417",
						"RAxML_bestTree.G15813"	=>	"307",
						"RAxML_bestTree.G15815"	=>	"290",
						"RAxML_bestTree.G15818"	=>	"641",
						"RAxML_bestTree.G15820"	=>	"358",
						"RAxML_bestTree.G15821"	=>	"459",
						"RAxML_bestTree.G15822"	=>	"367",
						"RAxML_bestTree.G15823"	=>	"1199",
						"RAxML_bestTree.G15826"	=>	"809",
						"RAxML_bestTree.G15827"	=>	"471",
						"RAxML_bestTree.G15830"	=>	"397",
						"RAxML_bestTree.G15831"	=>	"433",
						"RAxML_bestTree.G15832"	=>	"239",
						"RAxML_bestTree.G15833"	=>	"437",
						"RAxML_bestTree.G15834"	=>	"665",
						"RAxML_bestTree.G15835"	=>	"400",
						"RAxML_bestTree.G15836"	=>	"474",
						"RAxML_bestTree.G15837"	=>	"329",
						"RAxML_bestTree.G15844"	=>	"207",
						"RAxML_bestTree.G15845"	=>	"669",
						"RAxML_bestTree.G15848"	=>	"464",
						"RAxML_bestTree.G15851"	=>	"693",
						"RAxML_bestTree.G15854"	=>	"517",
						"RAxML_bestTree.G15855"	=>	"430",
						"RAxML_bestTree.G15856"	=>	"310",
						"RAxML_bestTree.G15857"	=>	"303",
						"RAxML_bestTree.G15858"	=>	"326",
						"RAxML_bestTree.G15859"	=>	"943",
						"RAxML_bestTree.G15860"	=>	"336",
						"RAxML_bestTree.G15862"	=>	"481",
						"RAxML_bestTree.G15864"	=>	"292",
						"RAxML_bestTree.G15867"	=>	"403",
						"RAxML_bestTree.G15869"	=>	"221",
						"RAxML_bestTree.G15870"	=>	"439",
						"RAxML_bestTree.G15871"	=>	"296",
						"RAxML_bestTree.G15872"	=>	"513",
						"RAxML_bestTree.G15875"	=>	"610",
						"RAxML_bestTree.G15876"	=>	"428",
						"RAxML_bestTree.G15877"	=>	"274",
						"RAxML_bestTree.G15878"	=>	"348",
						"RAxML_bestTree.G15883"	=>	"482",
						"RAxML_bestTree.G15885"	=>	"250",
						"RAxML_bestTree.G15886"	=>	"819",
						"RAxML_bestTree.G15887"	=>	"329",
						"RAxML_bestTree.G15888"	=>	"557",
						"RAxML_bestTree.G15891"	=>	"254",
						"RAxML_bestTree.G15894"	=>	"263",
						"RAxML_bestTree.G15896"	=>	"531",
						"RAxML_bestTree.G15900"	=>	"378",
						"RAxML_bestTree.G15901"	=>	"213",
						"RAxML_bestTree.G15902"	=>	"347",
						"RAxML_bestTree.G15904"	=>	"489",
						"RAxML_bestTree.G15906"	=>	"564",
						"RAxML_bestTree.G15907"	=>	"264",
						"RAxML_bestTree.G15909"	=>	"559",
						"RAxML_bestTree.G15912"	=>	"330",
						"RAxML_bestTree.G15915"	=>	"931",
						"RAxML_bestTree.G15916"	=>	"242",
						"RAxML_bestTree.G15918"	=>	"249",
						"RAxML_bestTree.G15920"	=>	"271",
						"RAxML_bestTree.G15922"	=>	"387",
						"RAxML_bestTree.G15923"	=>	"512",
						"RAxML_bestTree.G15924"	=>	"985",
						"RAxML_bestTree.G15925"	=>	"332",
						"RAxML_bestTree.G15926"	=>	"380",
						"RAxML_bestTree.G15929"	=>	"258",
						"RAxML_bestTree.G15931"	=>	"1060",
						"RAxML_bestTree.G15932"	=>	"270",
						"RAxML_bestTree.G15933"	=>	"853",
						"RAxML_bestTree.G15936"	=>	"226",
						"RAxML_bestTree.G15940"	=>	"242",
						"RAxML_bestTree.G15942"	=>	"310",
						"RAxML_bestTree.G15944"	=>	"292",
						"RAxML_bestTree.G15948"	=>	"254",
						"RAxML_bestTree.G15949"	=>	"353",
						"RAxML_bestTree.G15950"	=>	"273",
						"RAxML_bestTree.G15951"	=>	"303",
						"RAxML_bestTree.G15952"	=>	"381",
						"RAxML_bestTree.G15953"	=>	"246",
						"RAxML_bestTree.G15954"	=>	"282",
						"RAxML_bestTree.G15957"	=>	"631",
						"RAxML_bestTree.G15958"	=>	"342",
						"RAxML_bestTree.G15959"	=>	"364",
						"RAxML_bestTree.G15962"	=>	"240",
						"RAxML_bestTree.G15963"	=>	"418",
						"RAxML_bestTree.G15964"	=>	"477",
						"RAxML_bestTree.G15966"	=>	"282",
						"RAxML_bestTree.G15967"	=>	"496",
						"RAxML_bestTree.G15968"	=>	"282",
						"RAxML_bestTree.G15971"	=>	"259",
						"RAxML_bestTree.G15974"	=>	"710",
						"RAxML_bestTree.G15975"	=>	"573",
						"RAxML_bestTree.G15976"	=>	"396",
						"RAxML_bestTree.G15977"	=>	"414",
						"RAxML_bestTree.G15978"	=>	"653",
						"RAxML_bestTree.G15979"	=>	"324",
						"RAxML_bestTree.G15980"	=>	"248",
						"RAxML_bestTree.G15985"	=>	"608",
						"RAxML_bestTree.G15989"	=>	"335",
						"RAxML_bestTree.G15990"	=>	"388",
						"RAxML_bestTree.G15991"	=>	"311",
						"RAxML_bestTree.G15993"	=>	"409",
						"RAxML_bestTree.G15994"	=>	"310",
						"RAxML_bestTree.G15996"	=>	"474",
						"RAxML_bestTree.G15998"	=>	"385",
						"RAxML_bestTree.G15999"	=>	"280",
						"RAxML_bestTree.G16000"	=>	"540",
						"RAxML_bestTree.G16001"	=>	"361",
						"RAxML_bestTree.G16003"	=>	"384",
						"RAxML_bestTree.G16005"	=>	"219",
						"RAxML_bestTree.G16008"	=>	"473",
						"RAxML_bestTree.G16009"	=>	"267",
						"RAxML_bestTree.G16010"	=>	"223",
						"RAxML_bestTree.G16011"	=>	"357",
						"RAxML_bestTree.G16014"	=>	"438",
						"RAxML_bestTree.G16015"	=>	"295",
						"RAxML_bestTree.G16018"	=>	"424",
						"RAxML_bestTree.G16019"	=>	"210",
						"RAxML_bestTree.G16020"	=>	"482",
						"RAxML_bestTree.G16021"	=>	"641",
						"RAxML_bestTree.G16024"	=>	"304",
						"RAxML_bestTree.G16026"	=>	"686",
						"RAxML_bestTree.G16031"	=>	"450",
						"RAxML_bestTree.G16035"	=>	"624",
						"RAxML_bestTree.G16036"	=>	"247",
						"RAxML_bestTree.G16037"	=>	"253",
						"RAxML_bestTree.G16038"	=>	"363",
						"RAxML_bestTree.G16039"	=>	"293",
						"RAxML_bestTree.G16040"	=>	"210",
						"RAxML_bestTree.G16041"	=>	"420",
						"RAxML_bestTree.G16044"	=>	"341",
						"RAxML_bestTree.G16047"	=>	"937",
						"RAxML_bestTree.G16048"	=>	"365",
						"RAxML_bestTree.G16050"	=>	"887",
						"RAxML_bestTree.G16051"	=>	"633",
						"RAxML_bestTree.G16052"	=>	"230",
						"RAxML_bestTree.G16053"	=>	"389",
						"RAxML_bestTree.G16057"	=>	"838",
						"RAxML_bestTree.G16060"	=>	"377",
						"RAxML_bestTree.G16061"	=>	"297",
						"RAxML_bestTree.G16063"	=>	"610",
						"RAxML_bestTree.G16065"	=>	"276",
						"RAxML_bestTree.G16067"	=>	"256",
						"RAxML_bestTree.G16069"	=>	"378",
						"RAxML_bestTree.G16070"	=>	"463",
						"RAxML_bestTree.G16072"	=>	"215",
						"RAxML_bestTree.G16077"	=>	"698",
						"RAxML_bestTree.G16078"	=>	"585",
						"RAxML_bestTree.G16084"	=>	"443",
						"RAxML_bestTree.G16085"	=>	"565",
						"RAxML_bestTree.G16086"	=>	"392",
						"RAxML_bestTree.G16088"	=>	"503",
						"RAxML_bestTree.G16089"	=>	"233",
						"RAxML_bestTree.G16091"	=>	"485",
						"RAxML_bestTree.G16093"	=>	"437",
						"RAxML_bestTree.G16095"	=>	"207",
						"RAxML_bestTree.G16096"	=>	"533",
						"RAxML_bestTree.G16098"	=>	"493",
						"RAxML_bestTree.G16100"	=>	"501",
						"RAxML_bestTree.G16102"	=>	"380",
						"RAxML_bestTree.G16103"	=>	"443",
						"RAxML_bestTree.G16107"	=>	"240",
						"RAxML_bestTree.G16108"	=>	"267",
						"RAxML_bestTree.G16109"	=>	"387",
						"RAxML_bestTree.G16110"	=>	"755",
						"RAxML_bestTree.G16113"	=>	"360",
						"RAxML_bestTree.G16114"	=>	"397",
						"RAxML_bestTree.G16118"	=>	"339",
						"RAxML_bestTree.G16120"	=>	"225",
						"RAxML_bestTree.G16121"	=>	"336",
						"RAxML_bestTree.G16122"	=>	"491",
						"RAxML_bestTree.G16125"	=>	"450",
						"RAxML_bestTree.G16128"	=>	"265",
						"RAxML_bestTree.G16129"	=>	"324",
						"RAxML_bestTree.G16130"	=>	"405",
						"RAxML_bestTree.G16132"	=>	"294",
						"RAxML_bestTree.G16134"	=>	"330",
						"RAxML_bestTree.G16135"	=>	"230",
						"RAxML_bestTree.G16136"	=>	"378",
						"RAxML_bestTree.G16138"	=>	"306",
						"RAxML_bestTree.G16140"	=>	"342",
						"RAxML_bestTree.G16141"	=>	"489",
						"RAxML_bestTree.G16142"	=>	"359",
						"RAxML_bestTree.G16143"	=>	"379",
						"RAxML_bestTree.G16144"	=>	"471",
						"RAxML_bestTree.G16145"	=>	"758",
						"RAxML_bestTree.G16146"	=>	"736",
						"RAxML_bestTree.G16147"	=>	"378",
						"RAxML_bestTree.G16149"	=>	"274",
						"RAxML_bestTree.G16151"	=>	"261",
						"RAxML_bestTree.G16152"	=>	"736",
						"RAxML_bestTree.G16154"	=>	"531",
						"RAxML_bestTree.G16155"	=>	"341",
						"RAxML_bestTree.G16158"	=>	"410",
						"RAxML_bestTree.G16160"	=>	"412",
						"RAxML_bestTree.G16161"	=>	"287",
						"RAxML_bestTree.G16163"	=>	"470",
						"RAxML_bestTree.G16165"	=>	"275",
						"RAxML_bestTree.G16170"	=>	"292",
						"RAxML_bestTree.G16175"	=>	"261",
						"RAxML_bestTree.G16176"	=>	"231",
						"RAxML_bestTree.G16178"	=>	"297",
						"RAxML_bestTree.G16180"	=>	"252",
						"RAxML_bestTree.G16186"	=>	"267",
						"RAxML_bestTree.G16189"	=>	"261",
						"RAxML_bestTree.G16196"	=>	"295",
						"RAxML_bestTree.G16199"	=>	"481",
						"RAxML_bestTree.G16200"	=>	"207",
						"RAxML_bestTree.G16206"	=>	"273",
						"RAxML_bestTree.G16213"	=>	"245",
						"RAxML_bestTree.G16224"	=>	"280",
						"RAxML_bestTree.G16229"	=>	"231",
						"RAxML_bestTree.G16230"	=>	"269",
						"RAxML_bestTree.G16242"	=>	"211",
						"RAxML_bestTree.G16265"	=>	"209",
						"RAxML_bestTree.G16273"	=>	"259",
						"RAxML_bestTree.G16277"	=>	"267",
						"RAxML_bestTree.G16278"	=>	"247",
						"RAxML_bestTree.G16281"	=>	"241",
						"RAxML_bestTree.G16289"	=>	"247",
						"RAxML_bestTree.G16295"	=>	"285",
						"RAxML_bestTree.G16298"	=>	"298",
						"RAxML_bestTree.G16303"	=>	"269",
						"RAxML_bestTree.G16305"	=>	"273",
						"RAxML_bestTree.G16307"	=>	"238",
						"RAxML_bestTree.G16316"	=>	"367",
						"RAxML_bestTree.G16320"	=>	"242",
						"RAxML_bestTree.G16327"	=>	"268",
						"RAxML_bestTree.G16332"	=>	"645",
						"RAxML_bestTree.G16335"	=>	"219",
						"RAxML_bestTree.G16342"	=>	"289",
						"RAxML_bestTree.G16347"	=>	"274",
						"RAxML_bestTree.G16351"	=>	"302",
						"RAxML_bestTree.G16353"	=>	"307",
						"RAxML_bestTree.G16360"	=>	"351",
						"RAxML_bestTree.G16365"	=>	"249",
						"RAxML_bestTree.G16368"	=>	"256",
						"RAxML_bestTree.G16378"	=>	"300",
						"RAxML_bestTree.G16383"	=>	"273",
						"RAxML_bestTree.G16391"	=>	"270",
						"RAxML_bestTree.G16394"	=>	"447",
	);
	
# get gene length
my $length = 0;

if ( !exists $gene_lengths{$tree} ) {

	print STDERR "ERR: aln sequence length for tree $tree not found in coded hash :-(\n";
}
else {
	
	$length = $gene_lengths{$tree};
}

# create outinfile
$tree =~ /RAxML_bestTree\.(\w+)/g;
my $outfile = "infile" . "_" . "$1"; 
open (OUT, ">", $outfile) or die "Cannot create outfile\n";


# print out to file
print OUT "Sequence length = $length;\n\n";
print OUT `cat $tree`, "\n\n";
print OUT "# Fix root to 1\n";
print OUT "mrca: Homo_sapie, Callorhinc, fixage=1;\n\n";
print OUT "name of mrca: Homo_sapie, Callorhinc, name=root;\n";
print OUT "name of mrca: Homo_sapie, Danio_reri, name=osteichthyes;\n";

print STDERR "Done!\n\n";